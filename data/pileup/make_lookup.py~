data = {}
mc = {}
mc['2017'] = [3.39719372278e-05 , 7.09404093868e-06 , 1.33055464175e-05 , 3.24598549923e-05 , 5.72867356823e-05 , 9.04581174836e-05 ,
           0.000128294472233 , 0.000133290333906 , 0.000354661111487 , 0.000365025829524 , 0.000748454185668 , 0.00131064152811 ,
           0.00239722453989 , 0.00396015681326 , 0.00604592775926 , 0.00867346674204 , 0.0117365913466 , 0.0150408064947 ,
           0.0181213282049 , 0.0210592914373 , 0.0236411113292 , 0.0253431461751 , 0.0264689903706 , 0.0274818129838 ,
           0.0286782942712 , 0.0296122319996 , 0.0304959956557 , 0.0311743561178 , 0.0310999844223 , 0.0312614291906 ,
           0.0309693068266 , 0.0311890076846 , 0.0313009992242 , 0.0311588943005 , 0.0307730678469 , 0.0301437042654 ,
           0.0290457569063 , 0.0274067521095 , 0.0264933928847 , 0.0255935695022 , 0.0236029941589 , 0.0216860994697 ,
           0.0194945037365 , 0.0176285468042 , 0.0161909107119 , 0.0145961921662 , 0.0133738936856 , 0.0128812640905 ,
           0.0122986631468 , 0.0123550407588 , 0.0121635487303 , 0.0122592775151 , 0.0122174331918 , 0.012256577611 ,
           0.0122623872012 , 0.0122849131003 , 0.0121013503522 , 0.0119579220191 , 0.0115316165611 , 0.0105387317017 ,
           0.0093677630648 , 0.00806157849729 , 0.00658059539273 , 0.00522938510403 , 0.00403735646978 , 0.00350053654984 ,
           0.00294051785022 , 0.00213980441913 , 0.00150587945245 , 0.00104267522693 , 0.000709258776624 , 0.000471159350127 ,
           0.000314775970764 , 0.000203195770155 , 0.000186685458175 , 0.000140996155096 , 8.26834366308e-05 , 5.38383137609e-05 ,
           3.7845748011e-05 , 2.21872105612e-05 , 1.26588029161e-05 , 1.24309244711e-05 , 7.63092975831e-06 , 5.12305587108e-06 ,
           3.26505528392e-06 , 1.78824575414e-06 , 9.68385052147e-07 , 2.10482403418e-06 , 1.34407571295e-06 , 0.0 ,
           2.53864385513e-07 , 3.06239684278e-07 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 ,
              0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0, 0.0]

data['2017'] = [6.664595e-06, 2.572349e-05, 4.980694e-05, 9.069392e-05, 1.007774e-04, 1.453939e-04, 1.559755e-04, 1.670923e-04,
             2.314655e-04, 5.537831e-04, 1.100383e-03, 2.080586e-03, 3.283531e-03, 4.718383e-03, 6.682845e-03, 9.411571e-03,
             1.307260e-02, 1.728344e-02, 2.142947e-02, 2.526246e-02, 2.862496e-02, 3.133638e-02, 3.341586e-02, 3.503546e-02,
             3.643260e-02, 3.774157e-02, 3.882533e-02, 3.945822e-02, 3.949982e-02, 3.891851e-02, 3.778724e-02, 3.621496e-02,
             3.427132e-02, 3.201869e-02, 2.957844e-02, 2.711182e-02, 2.474993e-02, 2.257008e-02, 2.063220e-02, 1.901592e-02,
             1.781627e-02, 1.711101e-02, 1.692784e-02, 1.722276e-02, 1.786736e-02, 1.864803e-02, 1.928773e-02, 1.949956e-02,
             1.906176e-02, 1.787640e-02, 1.600798e-02, 1.366311e-02, 1.111544e-02, 8.634517e-03, 6.425014e-03, 4.598872e-03,
             3.181565e-03, 2.138032e-03, 1.402530e-03, 9.022947e-04, 5.716968e-04, 3.581350e-04, 2.226195e-04, 1.377962e-04,
             8.522737e-05, 5.285354e-05, 3.296921e-05, 2.074185e-05, 1.318567e-05, 8.476808e-06, 5.509668e-06, 3.616271e-06,
             2.392409e-06, 1.591868e-06, 1.062969e-06, 7.108766e-07, 4.752905e-07, 3.172282e-07, 2.111062e-07, 1.399296e-07,
             9.230636e-08, 6.055587e-08, 3.948321e-08, 2.557175e-08, 1.644318e-08, 1.049290e-08, 6.642265e-09, 4.169587e-09,
             2.594705e-09, 1.600218e-09, 9.778210e-10, 5.918816e-10, 3.548329e-10, 2.106470e-10, 1.238134e-10, 7.204549e-11,
             4.149790e-11, 2.365835e-11, 1.334891e-11, 7.453799e-12, 4.118621e-12, 2.251865e-12, 1.218220e-12, 6.520498e-13,
             3.452926e-13, 1.808951e-13, 9.375237e-14, 4.806589e-14, 2.437673e-14, 1.222877e-14, 6.067993e-15, 2.978160e-15,
             1.445698e-15, 6.941034e-16, 3.295878e-16, 1.547783e-16, 7.188469e-17, 3.301456e-17, 1.499410e-17, 6.733607e-18]

mc['2018'] = [4.695341e-10, 1.206213e-06, 1.162593e-06, 6.118058e-06, 1.626767e-05, 3.508135e-05, 7.12608e-05,  0.0001400641,
           0.0002663403, 0.0004867473, 0.0008469, 0.001394142, 0.002169081, 0.003198514, 0.004491138, 0.006036423,
           0.007806509, 0.00976048, 0.0118498, 0.01402411, 0.01623639, 0.01844593, 0.02061956, 0.02273221,
           0.02476554, 0.02670494, 0.02853662, 0.03024538, 0.03181323, 0.03321895, 0.03443884, 0.035448,
           0.03622242, 0.03674106, 0.0369877, 0.03695224, 0.03663157, 0.03602986, 0.03515857, 0.03403612,
           0.0326868, 0.03113936, 0.02942582, 0.02757999, 0.02563551, 0.02362497, 0.02158003, 0.01953143,
           0.01750863, 0.01553934, 0.01364905, 0.01186035, 0.01019246, 0.008660705, 0.007275915, 0.006043917,
           0.004965276, 0.004035611, 0.003246373, 0.002585932,0.002040746, 0.001596402, 0.001238498, 0.0009533139,
           0.0007282885, 0.000552306, 0.0004158005, 0.0003107302, 0.0002304612, 0.0001696012, 0.0001238161, 8.96531e-05,
           6.438087e-05, 4.585302e-05, 3.23949e-05,2.271048e-05, 1.580622e-05, 1.09286e-05, 7.512748e-06, 5.140304e-06,
           3.505254e-06, 2.386437e-06, 1.625859e-06, 1.111865e-06, 7.663272e-07,5.350694e-07, 3.808318e-07, 2.781785e-07,
           2.098661e-07, 1.642811e-07,1.312835e-07, 1.081326e-07, 9.141993e-08, 7.890983e-08, 6.91468e-08,6.119019e-08,
           5.443693e-08, 4.85036e-08, 4.31486e-08, 3.822112e-08, 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 ,
           0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 , 0.0 ,]

data['2018'] = [4.857952e-06, 1.705287e-05, 5.203413e-05, 1.136752e-04, 2.002126e-04, 3.106905e-04, 4.579615e-04, 6.662661e-04,
             9.419852e-04, 1.304785e-03, 1.817582e-03, 2.543718e-03, 3.536624e-03, 4.836934e-03, 6.479588e-03, 8.499125e-03,
             1.091434e-02, 1.370439e-02, 1.678807e-02, 2.001629e-02, 2.318735e-02, 2.609085e-02, 2.856827e-02, 3.056144e-02,
             3.211736e-02, 3.334816e-02, 3.437966e-02, 3.531335e-02, 3.620764e-02, 3.707663e-02, 3.789819e-02, 3.862730e-02,
             3.920914e-02, 3.958677e-02, 3.970240e-02, 3.949747e-02, 3.891383e-02, 3.790023e-02, 3.642255e-02, 3.447446e-02,
             3.208496e-02, 2.932003e-02, 2.627793e-02, 2.307904e-02, 1.985237e-02, 1.672182e-02, 1.379378e-02, 1.114828e-02,
             8.834996e-03, 6.873349e-03, 5.256634e-03, 3.958565e-03, 2.940632e-03, 2.158863e-03, 1.569172e-03, 1.131051e-03,
             8.095429e-04, 5.758975e-04, 4.073801e-04, 2.865517e-04, 2.003426e-04, 1.391215e-04, 9.586692e-05, 6.549065e-05,
             4.431358e-05, 2.967699e-05, 1.966063e-05, 1.288066e-05, 8.344654e-06, 5.346382e-06, 3.388533e-06, 2.125329e-06,
             1.319727e-06, 8.116338e-07, 4.945375e-07, 2.986064e-07, 1.786892e-07, 1.059669e-07, 6.226244e-08, 3.623437e-08,
             2.087677e-08, 1.190231e-08, 6.710919e-09, 3.739941e-09, 2.058878e-09, 1.119023e-09, 6.001559e-10, 3.174652e-10,
             1.655557e-10, 8.508168e-11, 4.307423e-11, 2.147592e-11, 1.054187e-11, 5.093417e-12, 2.421767e-12, 1.132936e-12,
             5.213823e-13, 2.360057e-13, 1.050627e-13, 4.599248e-14, 1.979678e-14, 8.377884e-15, 3.485573e-15, 1.425553e-15,
             5.731116e-16, 2.264752e-16, 8.796199e-17, 3.357735e-17, 1.259770e-17, 4.644727e-18, 1.683580e-18, 5.990986e-19,
             2.092040e-19, 7.182307e-20, 2.402734e-20, 8.295504e-21, 2.476434e-21, 7.085869e-22, 0.000000e+00, 0.000000e+00]

import numpy as np
from numpy import inf, nan
from coffea.lookup_tools import dense_lookup
for year in ['2017', '2018']:
    print(len(data[year]))
    print(len(mc[year]))
    weight = np.array(data[year])/np.array(mc[year])
    weight[weight==inf] = 0
    weight = np.nan_to_num(weight)
    arr = np.array(range(120))
    lookup = dense_lookup.dense_lookup(weight, arr)
    print(lookup(125))
